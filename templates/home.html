{{ template "head" . }}

<h1 class="title">Projects</h1>
<div class="action">
	<a href="/new-project">+ Add Project</a>
</div>

<div class="content">
{{ range . }}
<div class="project">
	<h2 class="project-title"><a href="/issues?cid={{ .Crawl.Id }}">{{ .Project.URL }}</a></h2>
	{{ if .Crawl.Id }}
		{{ if .Crawl.End.Valid }}
			<div>
				Last crawled on {{ .Crawl.Start.Format "Jan 02, 2006" }}. Crawl duration was {{ .Crawl.TotalTime }}.<br>
				{{ .TotalCount }} {{ if eq .TotalCount 1 }}page{{ else }}pages{{end }} crawled.<br>
			</div>
			<p class="actions">
						<a class="button" href="/crawl?pid={{ .Project.Id }}">Crawl Now</a>
						{{ if gt .TotalIssues 0 }}
							<a class="button" href="/issues?cid={{ .Crawl.Id }}">View Issues</a>
						{{ else }}
							<p><b>ðŸŽ‰ Well done! this project does not have any issue.</b></p>
						{{ end }}
					</p>
		{{ else }}
		<p><b>Now crawling...</b></p>
		{{ end }}
	{{ else }}
		<div><b>This project has not been crawled yet.</b></div>
		<p class="actions">
			<a class="button" href="/crawl?pid={{ .Project.Id }}">Crawl Now</a>
		</p>
	{{ end }}
</div>
{{ end }}
</div>
{{ template "footer" . }}