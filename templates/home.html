{{ template "head" . }}

<div class="content">
	<h1 class="title">Projects</h1>
	<div class="action">
		{{ if lt (len .Data.Projects) .Data.MaxProjects }}
			<a href="/new-project" style="font-size: 1rem">+ Add Project</a>
		{{ end }}
	</div>
</div>

<div class="content">
{{ range .Data.Projects }}
	<div class="project">
		<h2 class="project-title">{{ .Project.URL }}</h2>
		{{ if .Crawl.Id }}
			{{ if .Crawl.IssuesEnd.Valid }}
				<div>
					Last crawled on {{ .Crawl.Start.Format "Jan 02, 2006" }}. Crawl duration was {{ .Crawl.TotalTime }}.<br>
						{{ .Crawl.TotalURLs }}
						{{ if eq .Crawl.TotalURLs 1 }}URL{{ else }}URLs{{end }}
						crawled{{ if .Project.IgnoreRobotsTxt }} ignoring the robots.txt file{{ end }}.
				</div>
				<p>
					<a class="button"  href="/crawl?pid={{ .Project.Id }}">crawl now</a>
					<a class="button"  href="/issues?cid={{ .Crawl.Id }}">view report</a>
				</p>
			{{ else }}
				<p>Now crawling...</p>
			{{ end }}
		{{ else }}
			<div>This project has not been crawled yet.</div>
			<p><a class="button" href="/crawl?pid={{ .Project.Id }}">crawl Now</a></p>
		{{ end }}
	</div>
{{ end }}
</div>

{{ template "footer" . }}